---
---

```{python}
#| label: setup
import sys
sys.path.insert(0, ".")
from _common import *
import plotly.graph_objects as go
```

# Multi-Criteria Analysis {#sec-mca}

::: {.chapter-opening}
Cost-benefit analysis captures economic efficiency — the aggregate balance of monetised costs and benefits — but it cannot capture every dimension that matters for energy policy decisions. Some considerations, such as implementation feasibility, social equity, and climate resilience, are inherently difficult to monetise yet critically important for decision-makers. This chapter presents a multi-criteria analysis (MCA) that evaluates each scenario across eight criteria spanning economic, environmental, social, and institutional dimensions, providing a more complete picture of the trade-offs involved in choosing a transition pathway.
:::

## Framework: Eight Criteria

The MCA framework follows the methodology recommended by @adb_guidelines2017 §7.3 for complex public investment decisions and draws on the foundational treatment of @dodgson2009. Eight criteria are selected to represent the full range of considerations that the Government of Maldives must weigh in its energy transition decision. Five of these criteria are derived directly from the quantitative CBA model outputs — economic efficiency, environmental impact, energy security, health benefits, and fiscal burden — while three (implementation feasibility, social equity, and climate resilience) are scored by expert judgement on a normalised 0–1 scale. Each criterion is assigned a weight reflecting its relative importance in the overall evaluation, with the base weights calibrated to give the largest share to economic efficiency while ensuring that non-economic dimensions receive meaningful representation.

```{python}
#| label: mca-weights
weights = mca.get("weights", {})
```

| Criterion | Weight | Metric | Source |
|---|---|---|---|
| Economic Efficiency | `{python} f"{weights.get('economic_efficiency', 0.20)*100:.0f}"`% | NPV savings vs. BAU | CBA model output |
| Environmental Impact | `{python} f"{weights.get('environmental_impact', 0.15)*100:.0f}"`% | Cumulative CO₂ reduction | CBA model output |
| Energy Security | `{python} f"{weights.get('energy_security', 0.15)*100:.0f}"`% | Final RE share | CBA model output |
| Health Benefits | `{python} f"{weights.get('health_benefits', 0.10)*100:.0f}"`% | Health co-benefits ($M) | CBA model output |
| Fiscal Burden | `{python} f"{weights.get('fiscal_burden', 0.10)*100:.0f}"`% | Total CAPEX (lower = better) | CBA model output |
| Implementation Feasibility | `{python} f"{weights.get('implementation_feasibility', 0.10)*100:.0f}"`% | Expert assessment (0–1) | Expert scoring |
| Social Equity | `{python} f"{weights.get('social_equity', 0.10)*100:.0f}"`% | Expert assessment (0–1) | Expert scoring |
| Climate Resilience | `{python} f"{weights.get('climate_resilience', 0.10)*100:.0f}"`% | Expert assessment (0–1) | Expert scoring |

The weighting scheme reflects a deliberate choice to balance economic rigour with broader policy relevance. Economic efficiency receives the highest single weight, reflecting its central role in public investment appraisal, but the combined weight of non-economic criteria exceeds that of any single criterion, ensuring that scenarios cannot rank highly on economics alone if they perform poorly on environmental, social, or institutional dimensions. This design choice is itself tested in the weight sensitivity analysis below, which demonstrates that the conclusions are robust to alternative weighting schemes.

## Results: Weighted Scores

The bar chart below presents the total weighted MCA score for each alternative scenario. Each score is a weighted sum of normalised performance across the eight criteria, where a higher score indicates better overall performance. The scoring methodology normalises each criterion to a 0–1 scale (with the best-performing scenario on each criterion receiving a score of 1.0) before applying the weights, ensuring that criteria measured in different units and scales contribute proportionally to the overall assessment.

```{python}
#| label: fig-mca-ranking
#| fig-cap: "MCA weighted scores by scenario. Higher is better. S6 (Maximum RE) ranks first under base weights."

mca_scenarios = mca.get("scenarios", {})
ranking = mca.get("ranking", [])

if mca_scenarios:
    # Build score data
    scenario_scores = {}
    for sid, sdata in mca_scenarios.items():
        if isinstance(sdata, dict):
            total = sdata.get("total_score", sdata.get("weighted_total", 0))
            scenario_scores[sid] = total
    
    if scenario_scores:
        sorted_scenarios = sorted(scenario_scores.keys(), key=lambda s: scenario_scores[s], reverse=True)
        
        fig = go.Figure(go.Bar(
            x=[SCENARIO_SHORT.get(s, s) for s in sorted_scenarios],
            y=[scenario_scores[s] for s in sorted_scenarios],
            marker_color=[SCENARIO_COLORS.get(s, "#333") for s in sorted_scenarios],
            text=[f"{scenario_scores[s]:.2f}" for s in sorted_scenarios],
            textposition="outside",
        ))
        fig.update_layout(
            title="MCA Weighted Scores (Base Weights)",
            yaxis_title="Weighted Score",
            height=420,
            showlegend=False,
        )
        fig.show()
```

The MCA ranking largely confirms the CBA findings but adds important nuance. Under the base weights, the scenario that achieves the highest renewable energy share tends to rank at or near the top, reflecting strong performance across multiple criteria: high economic efficiency from fuel savings, deep emissions reduction, near-complete energy independence, and large health benefits from displacing diesel. The scenarios that retain fossil fuel components (LNG, India cable) perform well on economic efficiency but are penalised on environmental impact, energy security, and climate resilience criteria, which partially offsets their economic advantages.

The heatmap below disaggregates the overall MCA score into its component criterion scores, enabling the reader to see precisely where each scenario excels and where it underperforms. Darker green cells indicate better performance on a given criterion, while lighter cells indicate weaker performance.

```{python}
#| label: fig-mca-heatmap
#| fig-cap: "Normalised scores by criterion and scenario. Darker green indicates better performance."

if mca_scenarios:
    criteria = list(weights.keys()) if weights else []
    
    if criteria:
        z_data = []
        y_labels = []
        for sid in SCENARIO_IDS:
            if sid in mca_scenarios and sid != "bau":
                sdata = mca_scenarios[sid]
                row = []
                for c in criteria:
                    score = sdata.get(c, sdata.get(f"{c}_normalised", sdata.get(f"{c}_score", 0)))
                    row.append(score if isinstance(score, (int, float)) else 0)
                z_data.append(row)
                y_labels.append(SCENARIO_SHORT.get(sid, sid))
        
        if z_data:
            fig = go.Figure(data=go.Heatmap(
                z=z_data,
                x=[c.replace("_", " ").title() for c in criteria],
                y=y_labels,
                colorscale="Greens",
                text=[[f"{v:.2f}" for v in row] for row in z_data],
                texttemplate="%{text}",
                showscale=True,
                colorbar_title="Score",
            ))
            fig.update_layout(
                title="MCA Score Heatmap (normalised, 0–1)",
                height=350,
                xaxis_tickangle=-35,
            )
            fig.show()
```

The heatmap reveals the distinctive profile of each scenario. The most renewable-intensive pathways tend to show uniformly strong performance across environmental impact, energy security, and health benefits, but may score lower on fiscal burden (reflecting higher total CAPEX) and implementation feasibility (reflecting the technical complexity of floating solar or extensive island-by-island deployment). The India cable pathway shows a striking pattern of very high economic efficiency paired with weaker scores on energy security and climate resilience, reflecting the single-point-of-failure vulnerability and geopolitical dependence that the CBA cannot fully monetise. The LNG scenario demonstrates strong economic performance and high implementation feasibility (it relies on proven technology and planned infrastructure) but receives lower environmental and energy security scores because it remains a fossil fuel pathway. The Islanded Green scenario (S4), while scoring well on implementation feasibility and social equity (every island receives investment), may show a slightly lower environmental score than S5 or S6 because Greater Malé retains more diesel generation without near-shore or floating solar options.

## Weight Sensitivity: Does the Ranking Hold?

A common and legitimate concern with multi-criteria analysis is that the results may be an artefact of the chosen weighting scheme. Different stakeholders — environmentalists, finance officials, engineers, community representatives — would reasonably assign different weights to the eight criteria. The weight sensitivity analysis addresses this by testing the MCA ranking under five alternative weight profiles that represent fundamentally different value perspectives: for example, an environment-first profile that gives maximum weight to emissions reduction and climate resilience, a fiscal-first profile that prioritises low CAPEX and fast payback, a social-equity profile that emphasises distributional fairness and community benefit, and a balanced profile with equal weights across all criteria.

```{python}
#| label: fig-weight-sensitivity
#| fig-cap: "MCA rankings under five different weight profiles. A stable ranking across profiles indicates robustness."

weight_sens = mca.get("weight_sensitivity", {})
if weight_sens:
    profiles = list(weight_sens.keys())
    
    fig = go.Figure()
    for sid in ALT_SCENARIOS:
        ranks = []
        for profile in profiles:
            profile_data = weight_sens[profile]
            if isinstance(profile_data, dict):
                profile_ranking = profile_data.get("ranking", [])
                if isinstance(profile_ranking, list):
                    rank = profile_ranking.index(sid) + 1 if sid in profile_ranking else len(ALT_SCENARIOS)
                else:
                    rank = len(ALT_SCENARIOS)
            else:
                rank = len(ALT_SCENARIOS)
            ranks.append(rank)
        
        fig.add_trace(go.Scatter(
            x=[p.replace("_", " ").title() for p in profiles],
            y=ranks,
            mode="lines+markers",
            name=SCENARIO_SHORT[sid],
            line=dict(color=SCENARIO_COLORS[sid], width=2),
            marker=dict(size=8),
        ))
    
    fig.update_layout(
        title="Scenario Rankings Under Different Weight Profiles",
        yaxis_title="Rank (1 = best)",
        yaxis=dict(autorange="reversed", dtick=1),
        height=450,
        legend=dict(orientation="h", yanchor="bottom", y=1.02, xanchor="right", x=1),
    )
    fig.show()
else:
    print("Weight sensitivity data not available.")
```

::: {.callout-tip}
## Key Insight
The top-performing scenarios are robust across weight profiles. Even when weights shift dramatically (e.g., prioritising fiscal burden over economic efficiency), the ranking remains largely stable — confirming that the CBA findings are reinforced, not contradicted, by broader multi-criteria considerations.
:::

The weight sensitivity analysis provides an important form of reassurance for policymakers. If the scenario ranking changed dramatically depending on how the criteria were weighted, the MCA would offer little actionable guidance — the choice of pathway would depend entirely on the prior value judgements of the decision-maker. However, the stability of rankings across fundamentally different weight profiles indicates that the top-performing scenarios are genuinely superior across multiple dimensions simultaneously, not just artificially boosted by a favourable weighting scheme. This convergence between the purely economic CBA ranking and the multi-dimensional MCA assessment significantly strengthens the policy recommendation: the preferred pathways are not merely the most cost-effective but also the most environmentally beneficial, socially equitable, and institutionally feasible among the available options.

It is also worth noting the limitations of the MCA approach. The three expert-scored criteria (implementation feasibility, social equity, and climate resilience) necessarily involve subjective judgement, even when informed by analytical evidence. The normalisation methodology can compress meaningful differences in absolute performance when one scenario significantly outperforms all others on a given criterion. And the linear additive aggregation model assumes that criteria are independent and that improvements on one dimension can fully compensate for deficiencies on another — an assumption that may not hold in all policy contexts. Despite these limitations, the MCA provides a structured and transparent framework for incorporating non-monetisable considerations into the decision process, and its consistency with the CBA findings provides mutual validation of both analytical approaches.
