{
  "hash": "921caac898db97707a4e075d7812a768",
  "result": {
    "engine": "jupyter",
    "markdown": "---\ntitle: \"Appendix A — Technical Methodology\"\n---\n\n\n\nThis appendix documents the complete mathematical specification of the CBA model. Every equation is traced to its parameters in `parameters.csv`. For the policy summary, see @sec-methodology.\n\nEquations follow the model's computation pipeline — demand, costs, emissions, NPV, sensitivity — and are labelled by prefix (EQ-D for demand, EQ-C for costs, EQ-E for emissions, EQ-N for NPV, EQ-L for least-cost).\n\n## A.1 Model Architecture {#sec-arch}\n\nA single parameter file (`parameters.csv`) serves as the authoritative source for every numeric value. Changing any parameter propagates automatically through the entire computation chain, ensuring consistency across sensitivity analysis, Monte Carlo, and scenario calibration.\n\n**Architecture:**\n\n```\nparameters.csv  →  config.py  →  get_config()  →  model code\n     ↓                                                ↓\n SINGLE SOURCE                                  scenarios/*.py\n OF TRUTH for                                   costs.py\n all numbers                                    demand.py\n                                                cba/npv_calculator.py\n                                                     ↓\n                                                outputs/*.json\n                                                     ↓\n                                                This report\n```\n\n**Key design principles:**\n\n1. Every parameter lives in `parameters.csv` with 7 columns: Category, Parameter, Value, Low, High, Unit, Source\n2. `config.py` loads the CSV into typed Python dataclasses via `get_config()`\n3. No numeric parameter appears as a literal in any `.py` script — only mathematical constants (π, 8760 hours/year, unit conversions)\n4. Sensitivity analysis and Monte Carlo work by modifying the config object, ensuring parameter consistency\n\nEvery numeric input can be traced to a specific CSV row with its source, bounds, and unit.\n\n**Horizons:** 20 years (2026–2046), 30 years (2026–2056, default), 50 years (2026–2076)\n\n**Scenarios:** S1–S7 as described in @sec-scenarios\n\n**Discount rate:** 6% real (ADB SIDS standard), with declining discount rate sensitivity (3.5% → 3.0% → 2.5%)\n\n---\n\n## A.2 Demand Module\n\nDemand has grown at ~5%/yr (population, urbanisation, tourism). The equations project forward with scenario-specific growth and price-induced effects.\n\n### EQ-D1: Compound Demand Growth\n\n$$D(t) = D_0 \\times (1 + g)^{t - t_0}$$\n\nwhere $D_0$ = base demand in 2026 (1,200 GWh), $g$ = scenario-specific growth rate, and $t_0$ = 2026.\n\n### EQ-D2: Peak Demand from Energy\n\n$$P(t) = \\frac{D(t) \\times 1000}{8760 \\times LF}$$\n\nwhere $LF$ = load factor (0.68, empirical from 2018 Island Electricity Data Book).\n\n### EQ-D3: Induced Demand (Price Elasticity)\n\nApplied in the Full Integration scenario (S2) only, where imported electricity reduces the effective price:\n\n$$D'(t) = D(t) \\times \\left(1 + \\varepsilon \\times (-\\Delta p)\\right)$$\n\nwhere $\\varepsilon$ = price elasticity of demand (−0.3, Wolfram et al. 2012; Burke et al. 2015), and $\\Delta p$ = fractional price reduction from cable import.\n\n### EQ-D4: Sectoral Demand Split\n\n$$D_r(t) = D(t) \\times s_r, \\quad D_c(t) = D(t) \\times s_c, \\quad D_p(t) = D(t) \\times s_p$$\n\nwhere $s_r = 0.52$, $s_c = 0.24$, $s_p = 0.24$ (SAARC 2005 Energy Balance for the Maldives).\n\n---\n\n## A.3 Cost Module\n\n### EQ-C1: Solar PV CAPEX\n\n$$\\text{CAPEX}_{\\text{solar}}(t) = C_{\\text{solar}} \\times (1 - \\delta_s)^{t-t_0} \\times Q_{\\text{kW}} \\times (1 + \\alpha)$$\n\nwhere $C_{\\text{solar}}$ = initial CAPEX ($/kW), $\\delta_s$ = annual cost decline rate, and $\\alpha$ = climate adaptation premium (7.5%).\n\n### EQ-C2: Solar PV Generation (Temperature Derating + Degradation)\n\n$$G_{\\text{solar}}(t) = Q_{\\text{MW}} \\times 8760 \\times CF \\times f_T \\times f_D(t)$$\n\nTemperature derating:\n$$T_{\\text{cell}} = T_{\\text{amb}} + k_{\\text{NOCT}} \\times \\frac{GHI}{24}$$\n$$f_T = \\max\\left(0, \\; 1 - k_t \\times (T_{\\text{cell}} - 25)\\right)$$\n\nAnnual degradation:\n$$f_D(t) = (1 - d)^{t - t_{\\text{install}}}$$\n\nwhere $k_t = 0.005$ $/°C (IEC 61215), $k_{\\text{NOCT}} = 25.6$ (OnSSET), and $d = 0.005$/yr (Jordan & Kurtz 2013).\n\n### EQ-C3: Battery CAPEX\n\n$$\\text{CAPEX}_{\\text{batt}}(t) = C_{\\text{batt}} \\times (1 - \\delta_b)^{t-t_0} \\times Q_{\\text{kWh}} \\times (1 + \\alpha)$$\n\nwhere $C_{\\text{batt}}$ = battery CAPEX ($/kWh), $\\delta_b$ = annual cost decline rate.\n\n### EQ-C4: Diesel Fuel Cost (Two-Part Curve)\n\n$$F(t) = L(t) \\times P_f(t)$$\n\nFuel consumption uses the two-part Mandelli (2016) fuel curve:\n$$L(t) = Q_{\\text{kW}} \\times c_{\\text{idle}} \\times h + G_{\\text{kWh}} \\times c_{\\text{prop}}$$\n\nwhere $c_{\\text{idle}} = 0.08145$ L/hr/kW (idle/no-load coefficient) and $c_{\\text{prop}} = 0.246$ L/kWh (proportional coefficient), following OnSSET L266 (Mandelli 2016).\n\nFuel price escalation:\n$$P_f(t) = P_0 \\times (1 + e_f)^{t-t_0}$$\n\nOperating hours:\n$$h = \\min\\left(8760, \\; \\frac{G_{\\text{kWh}}}{Q_{\\text{kW}} \\times \\bar{l}}\\right), \\quad \\bar{l} = \\frac{l_{\\min} + 1}{2}$$\n\n### EQ-C5: T&D Loss Gross-Up\n\n$$G_{\\text{gross}} = \\frac{D_{\\text{net}}}{(1 - l_d) \\times (1 - l_c)}$$\n\nwhere $l_d = 0.11$ (distribution loss, World Bank WDI) and $l_c = 0.04$ (HVDC cable loss, Skog et al. CIGRÉ 2010 B1-106). Multiplicative formulation (not additive).\n\n### EQ-C6: Cable CAPEX (Full Breakdown)\n\n$$\\text{CAPEX}_{\\text{cable}} = \\left[L_{\\text{km}} \\times C_{\\text{cable/km}} + C_{\\text{conv/MW}} \\times P_{\\text{cap}} + C_{\\text{land}} \\times N_{\\text{land}}\\right] \\times (1 + r_{\\text{IDC}}) + C_{\\text{grid}} \\times (1 + \\alpha)$$\n\n### EQ-C7: PPA Import Cost\n\n$$\\text{PPA}(t) = G_{\\text{import}} \\times \\left(P_{\\text{PPA}} + P_{\\text{tx}}\\right) \\times (1 + e_{\\text{PPA}})^{t - t_{\\text{online}}}$$\n\n### EQ-C8: Connection Cost per Household\n\n$$\\text{CAPEX}_{\\text{connection}}(t) = \\begin{cases} C_{\\text{HH}} \\times N_{\\text{HH}} / Y_{\\text{rollout}} & \\text{if } t \\leq t_0 + Y_{\\text{rollout}} \\\\ 0 & \\text{otherwise} \\end{cases}$$\n\nwhere $C_{\\text{HH}} = \\$200$/household, $N_{\\text{HH}} = 100{,}000$, $Y_{\\text{rollout}} = 5$ years.\n\n---\n\n## A.4 Emissions Module\n\n### EQ-E1: Diesel CO₂ Emissions\n\n$$E_{\\text{diesel}} = G_{\\text{kWh}} \\times EF_{\\text{CO}_2}$$\n\nwhere $EF_{\\text{CO}_2} = 0.72$ kgCO₂/kWh (IPCC 2006 emission factor for diesel generation).\n\n### EQ-E2: Import Emissions (India Grid, Declining)\n\n$$E_{\\text{import}}(t) = G_{\\text{kWh}} \\times EF_{\\text{India}} \\times (1 - d_{\\text{India}})^{t - t_{\\text{base}}}$$\n\nwhere $EF_{\\text{India}} = 0.70$ kgCO₂/kWh and $d_{\\text{India}} = 0.02$/yr (2% annual grid decarbonisation).\n\n### EQ-E3: Social Cost of Carbon\n\n$$SCC(t) = SCC_0 \\times (1 + g_{\\text{SCC}})^{t - t_0}$$\n\nwhere $SCC_0 = \\$51$/tCO₂ (EPA 2023 interim at 3% discount rate) and $g_{\\text{SCC}} = 0.02$/yr.\n\n### EQ-E4: Environmental Externalities\n\n$$B_{\\text{env}}(t) = \\Delta D_{\\text{diesel}}(t) \\times \\left(C_{\\text{noise}} + C_{\\text{spill}} + C_{\\text{biodiversity}}\\right)$$\n\nwhere $C_{\\text{noise}} = \\$5$/MWh, $C_{\\text{spill}} = \\$3$/MWh, $C_{\\text{biodiversity}} = \\$2$/MWh (total: $10/MWh).\n\n---\n\n## A.5 NPV / CBA Calculator\n\n### EQ-N1: Net Present Value\n\n$$\\text{NPV} = \\sum_{t=t_0}^{T} \\frac{B(t) - C(t)}{(1 + r)^{t - t_0}}$$\n\nwhere $r = 0.06$ (6% real discount rate, ADB SIDS standard).\n\n**Benefit streams** $B(t)$:\n\n1. **Fuel savings:** BAU fuel cost − scenario fuel cost\n2. **Emission reduction:** (BAU emissions − scenario emissions) × SCC(t)\n3. **Health co-benefits:** Diesel reduction × $40/MWh (Parry et al. 2014, IMF WP/14/199)\n4. **Environmental externalities:** Diesel reduction × $10/MWh\n5. **Subsidy avoidance:** Diesel reduction × $0.15/kWh (current government subsidy rate)\n\n**Cost streams** $C(t)$:\n\n1. CAPEX (solar, wind, battery, cable, grid upgrades, connections)\n2. OPEX (solar, wind, battery, diesel O&M)\n3. PPA import costs (for cable scenarios)\n\n### EQ-N2: Incremental Analysis\n\n$$\\Delta\\text{NPV} = \\text{NPV}_{\\text{scenario}} - \\text{NPV}_{\\text{BAU}}$$\n\n### EQ-N3: Benefit-Cost Ratio\n\n$$\\text{BCR} = \\frac{\\sum_{t} PV(\\text{Benefits}_t)}{\\sum_{t} PV(\\text{Costs}_t)}$$\n\n### EQ-N4: Internal Rate of Return\n\nThe IRR is the discount rate $r^*$ that makes the NPV of the incremental cash flows equal to zero:\n\n$$\\sum_{t=t_0}^{T} \\frac{\\Delta B(t) - \\Delta C(t)}{(1 + r^*)^{t - t_0}} = 0$$\n\n### EQ-N5: Salvage Value\n\n$$S_T = \\text{CAPEX} \\times \\max\\left(0, \\; 1 - \\frac{T - t_{\\text{install}}}{\\tau_{\\text{tech}}}\\right)$$\n\nSalvage is computed at the end of the analysis horizon for any asset with remaining useful life. The value is discounted back to the base year and added to the NPV as a terminal benefit.\n\n### EQ-N6: Declining Discount Rate (DDR)\n\nFor the DDR sensitivity:\n\n| Years | Rate |\n|-------|------|\n| 0–30 | 3.5% |\n| 31–75 | 3.0% |\n| 76–125 | 2.5% |\n\nBased on HM Treasury Green Book, Drupp et al. (2018), and Weitzman (2001).\n\n$$PV_t = \\frac{1}{\\prod_{s=0}^{t-1}(1 + r_s)}$$\n\n---\n\n## A.6 Least-Cost Electrification Engine\n\nPer-island technology assignment is essential because the economics of small-island power generation vary dramatically with island size, population, solar resource, land availability, and diesel transport costs. An island with five hundred residents has fundamentally different optimal technology from one with fifty thousand.\n\nThe per-island technology assignment uses discounted LCOE computed over the project lifetime with reinvestment:\n\n### EQ-L1: Discounted LCOE (General Form)\n\n$$\\text{LCOE} = \\frac{\\sum_{y=0}^{N-1} \\frac{I_y + O_y + F_y - S_y}{(1+r)^y}}{\\sum_{y=0}^{N-1} \\frac{G_y}{(1+r)^y}}$$\n\nReinvestment occurs at year $y = \\tau_{\\text{tech}}$, $2\\tau_{\\text{tech}}$, … while $y < N$.\n\n### EQ-L2: Solar+Battery LCOE\n\nSizing:\n$$Q_{\\text{solar,kW}} = \\frac{D / (1 - l_d)}{CF_{\\text{eff}} \\times 8760}$$\n$$Q_{\\text{batt,kWh}} = \\frac{P_{\\text{kW}} \\times h_{\\text{batt}}}{DoD}$$\n\nSplit into separate LCOE components (different lifetimes):\n$$\\text{LCOE}_{\\text{solar+batt}} = \\text{LCOE}_{\\text{solar}} + \\text{LCOE}_{\\text{batt}}$$\n\n### EQ-L3: Solar Land Constraint\n\n$$Q_{\\text{solar,max}} = A_{\\text{island}} \\times f_{\\text{solar}} \\times \\frac{1000}{A_{\\text{panel}}}$$\n\nwhere $f_{\\text{solar}}$ is the usable land fraction for solar (varies by island density) and $A_{\\text{panel}}$ is the panel area requirement (m²/kW).\n\n---\n\n## A.7 Sensitivity & Monte Carlo\n\n### One-Way Sensitivity\n\nEach parameter is varied independently between its Low and High bounds while all others remain at base values. NPV change is computed for each variation:\n\n$$\\Delta\\text{NPV}_i^{\\pm} = \\text{NPV}(p_i^{\\pm}) - \\text{NPV}(p_i^{\\text{base}})$$\n\nResults are displayed as tornado diagrams ranked by $|\\Delta\\text{NPV}_i^+ - \\Delta\\text{NPV}_i^-|$.\n\n### Monte Carlo Simulation\n\n\n\n**Method:** 1000 iterations with Latin Hypercube Sampling (LHS) over 0 correlated parameters. Correlations imposed via Iman–Conover rank-correlation method.\n\nFor each iteration $k$:\n\n1. Sample parameter vector $\\mathbf{p}^{(k)}$ from the joint distribution (triangular marginals, Low–Base–High)\n2. Impose correlation structure via rank reordering\n3. Run full CBA with $\\mathbf{p}^{(k)}$ to obtain $\\text{NPV}^{(k)}$ for all scenarios\n4. Record scenario rankings\n\n**Convergence diagnostic:** Standard error of mean NPV falls below 1% of the mean after ~500 iterations.\n\n### Switching Values\n\nThe switching value analysis identifies the parameter value at which the preferred scenario changes:\n\n$$p_i^* : \\text{NPV}_A(p_i^*) = \\text{NPV}_B(p_i^*)$$\n\nThis is solved by linear interpolation between the Low and High NPV evaluations.\n\n---\n\n## A.8 Multi-Criteria Analysis\n\n### Scoring Methodology\n\nFor each criterion $j$ and scenario $i$:\n\n$$\\text{Score}_{ij} = \\frac{x_{ij} - \\min_i(x_{ij})}{\\max_i(x_{ij}) - \\min_i(x_{ij})}$$\n\nwith direction adjustment (higher-is-better vs. lower-is-better). Weighted aggregate:\n\n$$W_i = \\sum_{j=1}^{8} w_j \\times \\text{Score}_{ij}$$\n\n**Criteria:** Economic Efficiency (NPV), Cost Effectiveness (LCOE), Environmental Impact, Energy Security, Social Equity, Implementation Feasibility, Climate Resilience, Financial Viability.\n\n---\n\n## A.9 Financing Module\n\n### Grant Element Calculation\n\n$$GE = 1 - \\frac{\\sum_{t=1}^{T} \\frac{A_t}{(1+r_m)^t}}{L}$$\n\nwhere $A_t$ = annual repayment, $r_m$ = market interest rate (11.55%, World Bank WDI 2024), and $L$ = loan face value.\n\n### Weighted Average Cost of Capital\n\n$$\\text{WACC} = w_{\\text{ADB}} \\times r_{\\text{ADB}} + w_{\\text{comm}} \\times r_{\\text{comm}}$$\n\nwhere $w_{\\text{ADB}}$ = ADB-eligible share, $r_{\\text{ADB}} = 1\\%$, and $r_{\\text{comm}} = 11.55\\%$.\n\n---\n\n## A.10 Dispatch Model\n\nThe hourly dispatch simulation validates annual capacity factor assumptions using 8,760-hour profiles:\n\n1. **Solar output:** $G_{\\text{solar}}(h) = Q_{\\text{MW}} \\times \\frac{GHI(h)}{1000} \\times f_T(h)$\n2. **Battery charge/discharge:** Subject to $\\text{SOC}_{\\min} = 1 - DoD$, round-trip efficiency $\\eta_{\\text{RT}} = 0.88$\n3. **Diesel backstop:** Fills any gap, subject to minimum load fraction $l_{\\min} = 0.40$\n\nThe simulation uses hourly GHI and temperature data from `GHI_hourly.csv` and `Temperature_hourly.csv`.\n\n---\n\n## A.11 Parameter Traceability Summary\n\n::: {#tbl-param-count .cell tbl-cap='Parameter categories and counts' execution_count=3}\n\n::: {.cell-output .cell-output-display .cell-output-markdown execution_count=3}\n| Category | Parameters |\n|---|---|\n| Demand | 23 |\n| Investment Phasing | 20 |\n| Solar | 17 |\n| Dispatch | 13 |\n| Cable | 12 |\n| Macro | 11 |\n| LNG | 10 |\n| Economics | 10 |\n| Battery | 9 |\n| Distributional | 9 |\n| Benchmarks | 8 |\n| MCA Weights | 8 |\n| Near-Shore Solar | 8 |\n| One Grid | 7 |\n| WTE | 7 |\n| Electricity Structure | 7 |\n| Wind | 7 |\n| Climate | 6 |\n| PPA | 6 |\n| Transport Costs | 6 |\n| Financing | 6 |\n| Fuel | 6 |\n| Current System | 6 |\n| Transport Energy | 5 |\n| Transport EV | 5 |\n| Islanded | 5 |\n| RE Deployment | 5 |\n| Time | 4 |\n| Losses | 4 |\n| Tourism | 4 |\n| Transport Fleet | 4 |\n| Inter-Island Grid | 4 |\n| Cable Outage | 3 |\n| Health | 3 |\n| Environment | 3 |\n| Connection | 3 |\n| Diesel Gen | 3 |\n| MCA Scores IG | 3 |\n| MCA Scores FI | 3 |\n| MCA Scores LNG | 3 |\n| MCA Scores NS | 3 |\n| Transport Health | 3 |\n| MCA Scores MX | 3 |\n| MCA Scores NG | 3 |\n| Operations | 3 |\n| Supply Security | 2 |\n| Reliability | 2 |\n| Network | 1 |\n| Transport CO2 | 1 |\n| **Total** | **307** |\n:::\n:::\n\n\nEvery parameter in the table above flows through the same pipeline: `parameters.csv → config.py (load_parameters_from_csv) → get_config() → consuming module`. No exceptions. This ensures that sensitivity analysis and Monte Carlo automatically capture every parameter — there are no \"hidden\" values in the code.\n\n",
    "supporting": [
      "A-methodology-detail_files\\figure-docx"
    ],
    "filters": []
  }
}